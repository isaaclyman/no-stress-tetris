(function(e){function t(t){for(var n,c,s=t[0],a=t[1],u=t[2],h=0,d=[];h<s.length;h++)c=s[h],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var a=r[s];0!==i[a]&&(n=!1)}n&&(o.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},i={app:0},o=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=a;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("85ec"),i=r.n(n);i.a},"0daa":function(e,t,r){"use strict";var n=r("419b"),i=r.n(n);i.a},"1b65":function(e,t,r){},"419b":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"container"},[r("div",{staticClass:"header"},[r("h2",[e._v("No Stress Tetris")]),r("h4",[e._v("Score: "+e._s(e.score))])]),r("div",{staticClass:"body"},[r("div",{staticClass:"game"},[r("Game",{on:{"line-cleared":e.lineCleared}}),r("Instructions")],1)])])])},o=[],c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"gridEl",staticClass:"grid"},e._l(e.grid,(function(t,n){return r("div",{key:"line-"+n,staticClass:"line"},[e.clears.includes(n)?[e._l(t,(function(t,i){return r("div",{key:"line-"+n+"-cell-"+i,staticClass:"cell cell-cleared",class:{"cell-clearing":e.clearing}})})),r("div",{staticClass:"message",domProps:{textContent:e._s(e.message)}})]:e._l(t,(function(t,i){return r("div",{key:"line-"+n+"-cell-"+i,staticClass:"cell"},[t.hasBlock?r("div",{staticClass:"block",style:e.getStyle(t)}):e._e()])}))],2)})),0)},s=[],a=(r("4160"),r("c975"),r("a434"),r("159b"),r("d4ec")),u=r("bee2"),l=function(){function e(t){Object(a["a"])(this,e),this.subscribers=[],this.intervalTime=t,this.changeInterval(t)}return Object(u["a"])(e,[{key:"subscribe",value:function(e){if("function"!==typeof e)throw new Error("Subscribers to Clock must be functions.");this.subscribers.push(e)}},{key:"unsubscribe",value:function(e){var t=this.subscribers.indexOf(e);-1!==t&&this.subscribers.splice(t,1)}},{key:"changeInterval",value:function(e){var t=this;clearInterval(this.interval),this.intervalTime=e,this.isRunning=!0,this.interval=setInterval((function(){t.subscribers.forEach((function(e){return e()}))}),e)}},{key:"destroy",value:function(){this.subscribers=[],clearInterval(this.interval),this.isRunning=!1}},{key:"pause",value:function(){clearInterval(this.interval),this.isRunning=!1}},{key:"resume",value:function(){this.changeInterval(this.intervalTime)}},{key:"isPaused",value:function(){return!this.isRunning}}]),e}(),h=l,d=(r("a623"),r("d81d"),r("45fc"),r("5530")),f=r("b85c"),v=r("3835");r("b64b");function k(e,t){return function(){return{color:e,grid:t}}}var g={straight:k("blue",[[1,1,1,1]]),lshape:k("darkblue",[[1,0,0],[1,1,1]]),reverselShape:k("orange",[[0,0,1],[1,1,1]]),square:k("yellow",[[1,1],[1,1]]),squiggle:k("green",[[0,1,1],[1,1,0]]),reverseSquiggle:k("red",[[1,1,0],[0,1,1]]),key:k("purple",[[0,1,0],[1,1,1]])};function b(e){for(var t=e.length,r=e[0].length,n=[],i=r-1;i>=0;i--){for(var o=[],c=0;c<t;c++){var s=e[c][i];o.push(s)}n.push(o)}return n}function p(e){for(var t=Math.floor(4*Math.random()),r=0;r<=t;r++)e.grid=b(e.grid);return e}function y(){var e=Object.keys(g),t=Math.floor(Math.random()*e.length),r=e[t],n=g[r](),i=p(n);return i}var B=12,m=18;function w(){return{hasBlock:0,color:null}}function T(){for(var e=[],t=1;t<=m;t++)e.push(C());return e}function C(){for(var e=[],t=1;t<=B;t++)e.push(w());return e}var O=function(){function e(){Object(a["a"])(this,e),this.currentBlock={blockType:null,coordinates:[-1,-1],hasTouchedBottom:!1},this.grid=T()}return Object(u["a"])(e,[{key:"isSettled",value:function(){for(var e=0;e<this.grid.length;e++)for(var t=this.grid[e],r=0;r<t.length;r++)if(!this.isCellSettled(e,r))return!1;return!0}},{key:"isCellSettled",value:function(e,t){var r=this.grid[e][t];if(!r.hasBlock)return!0;if(e>=this.grid.length-1)return!0;var n=this.grid[e+1][t];return!!n.hasBlock}},{key:"exertGravity",value:function(){for(var e=T(),t=this.grid.length-1;t>=0;t--)for(var r=this.grid[t],n=0;n<r.length;n++){var i=r[n];if(i.hasBlock){var o=t-this.currentBlock.coordinates[0],c=n-this.currentBlock.coordinates[1],s=this.currentBlock.blockType.grid[o],a=s&&s[c];if(t!==this.grid.length-1){var u=e[t+1][n];u.hasBlock?(a&&(this.currentBlock.hasTouchedBottom=!0),e[t].splice(n,1,i)):e[t+1].splice(n,1,i)}else a&&(this.currentBlock.hasTouchedBottom=!0),e[t].splice(n,1,i)}}this.currentBlock.hasTouchedBottom||(this.currentBlock.coordinates[0]+=1);for(var l=0;l<this.grid.length;l++)for(var h=this.grid[l],d=0;d<h.length;d++)this.grid[l].splice(d,1,e[l][d])}},{key:"createBlock",value:function(e){var t=e.grid.length,r=e.grid[0].length,n=this.findSpace(r,t);if(n.some((function(e){return-1===e})))return!1;for(var i=Object(v["a"])(n,2),o=i[0],c=i[1],s=0;s<t;s++)for(var a=0;a<r;a++)this.grid[s+o].splice(a+c,1,{hasBlock:e.grid[s][a],color:e.color});return this.currentBlock={blockType:e,coordinates:[o,c],hasTouchedBottom:!1},!0}},{key:"findSpace",value:function(e,t){var r=this.grid[0],n=Math.round(r.length/2-e/2);if(_(this.grid,0,n,e,t))return[0,n];for(var i=0;i<r.length;i++){var o=r[i];if(!o.hasBlock&&_(this.grid,0,i,e,t))return[0,i]}return[-1,-1]}},{key:"getLineClears",value:function(){for(var e=[],t=0;t<this.grid.length;t++){var r=this.grid[t];r.every((function(e){return e.hasBlock}))&&e.push(t)}return e}},{key:"clearLines",value:function(e,t){var r,n=Object(f["a"])(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.grid.splice(i,1,C())}}catch(o){n.e(o)}finally{n.f()}this.forceSettle(t)}},{key:"forceSettle",value:function(e){var t=this;setTimeout((function(){t.exertGravity(),t.isSettled()?e&&e():t.forceSettle(e)}),50)}},{key:"moveCurrentBlockLeft",value:function(){if(this.currentBlock.hasTouchedBottom)return!1;var e=this.currentBlock.blockType.grid.length,t=this.currentBlock.blockType.grid[0].length;if(!_(this.getGridWithoutCurrentBlock(),this.currentBlock.coordinates[0],this.currentBlock.coordinates[1]-1,t,e))return!1;for(var r=0;r<e;r++)for(var n=this.grid[this.currentBlock.coordinates[0]+r],i=0;i<t;i++){var o=this.currentBlock.coordinates[1]+i;n.splice(o,1,w());var c=o-1;n.splice(c,1,{hasBlock:this.currentBlock.blockType.grid[r][i],color:this.currentBlock.blockType.color})}return this.currentBlock.coordinates[1]-=1,!0}},{key:"moveCurrentBlockRight",value:function(){if(this.currentBlock.hasTouchedBottom)return!1;var e=this.currentBlock.blockType.grid.length,t=this.currentBlock.blockType.grid[0].length;if(!_(this.getGridWithoutCurrentBlock(),this.currentBlock.coordinates[0],this.currentBlock.coordinates[1]+1,t,e))return!1;for(var r=0;r<e;r++)for(var n=this.grid[this.currentBlock.coordinates[0]+r],i=t-1;i>=0;i--){var o=this.currentBlock.coordinates[1]+i;n.splice(o,1,w());var c=o+1;n.splice(c,1,{hasBlock:this.currentBlock.blockType.grid[r][i],color:this.currentBlock.blockType.color})}return this.currentBlock.coordinates[1]+=1,!0}},{key:"rotateCurrentBlock",value:function(){if(this.currentBlock.hasTouchedBottom)return!1;var e=this.currentBlock.blockType.grid.length,t=this.currentBlock.blockType.grid[0].length,r=b(this.currentBlock.blockType.grid),n=r.length,i=r[0].length;if(!_(this.getGridWithoutCurrentBlock(),this.currentBlock.coordinates[0],this.currentBlock.coordinates[1],i,n))return!1;for(var o=0;o<e;o++)for(var c=this.grid[this.currentBlock.coordinates[0]+o],s=0;s<t;s++)c.splice(this.currentBlock.coordinates[1]+s,1,w());for(var a=0;a<n;a++)for(var u=this.grid[this.currentBlock.coordinates[0]+a],l=0;l<i;l++)u.splice(this.currentBlock.coordinates[1]+l,1,{hasBlock:r[a][l]?1:0,color:this.currentBlock.blockType.color});return this.currentBlock.blockType.grid=r,!0}},{key:"getGridWithoutCurrentBlock",value:function(){for(var e=this.grid.map((function(e){return e.map((function(e){return Object(d["a"])({},e)}))})),t=this.currentBlock.blockType.grid.length,r=this.currentBlock.blockType.grid[0].length,n=0;n<t;n++)for(var i=e[this.currentBlock.coordinates[0]+n],o=0;o<r;o++){var c=this.currentBlock.blockType.grid[n][o];c&&i.splice(this.currentBlock.coordinates[1]+o,1,w())}return e}}]),e}();function _(e,t,r,n,i){if(t<0||r<0)return!1;for(var o=0;o<i;o++){if(t+o>=e.length)return!1;for(var c=e[t+o],s=0;s<n;s++){if(r+s>=c.length)return!1;var a=e[t+o][r+s];if(a.hasBlock)return!1}}return!0}var S=new O,j=S,L={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Space:" "},x=function(){function e(){var t=this;Object(a["a"])(this,e),this.subscribers=[],window.addEventListener("keydown",(function(e){return t.onKeyDown(e)}))}return Object(u["a"])(e,[{key:"onKeyDown",value:function(e){var t,r=e.key,n=Object(f["a"])(this.subscribers);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.key===r&&(e.preventDefault(),i.callback())}}catch(o){n.e(o)}finally{n.f()}}},{key:"subscribe",value:function(e,t){this.subscribers.push({key:e,callback:t})}},{key:"destroy",value:function(){this.subscribers=[],window.removeEventListener("keydown",this.onKeyDown)}}]),e}(),I=["Everything's gonna be okay","You're a good person","You deserve a break","Better days are coming","Take a deep breath","It will all work out","There's nothing to worry about","You are loved","You've got this","You are good enough","You are smart enough","We're rooting for you","You're perfect just the way you are","You're doing a great job"],E=r("c8b5"),R=r.n(E),D=700,M={data:function(){return{clearing:!1,clears:[],clock:null,grid:null,keyboardListener:null,message:""}},mounted:function(){var e=this;this.grid=j.grid,this.clock=new h(D),this.clock.subscribe((function(){return e.tick()})),this.keyboardListener=new x,this.keyboardListener.subscribe(L.Left,(function(){return j.moveCurrentBlockLeft()})),this.keyboardListener.subscribe(L.Right,(function(){return j.moveCurrentBlockRight()})),this.keyboardListener.subscribe(L.Up,(function(){return j.rotateCurrentBlock()})),this.keyboardListener.subscribe(L.Down,(function(){return e.downKeyInput()})),this.keyboardListener.subscribe(L.Space,(function(){e.clock.isPaused()?e.clock.resume():e.clock.pause()}));var t=new R.a.Manager(this.$refs.gridEl);t.add(new R.a.Swipe({direction:R.a.DIRECTION_ALL,threshold:10})),t.on("swipe",(function(t){switch(t.direction){case R.a.DIRECTION_LEFT:j.moveCurrentBlockLeft();break;case R.a.DIRECTION_RIGHT:j.moveCurrentBlockRight();break;case R.a.DIRECTION_UP:j.rotateCurrentBlock();break;case R.a.DIRECTION_DOWN:e.downKeyInput();break}}))},methods:{beginClearLines:function(e,t){var r=this;e.length?(this.$emit("line-cleared"),this.clock.pause(),this.message="",this.clears=e,setTimeout((function(){r.clearing=!0,r.getEncouragement()}),100),setTimeout((function(){var e=r.clears;r.clears=[],j.clearLines(e,(function(){r.clearing=!1,t(),r.clock.resume()}))}),1e3)):t()},downKeyInput:function(){var e=this;this.clock.pause(),j.forceSettle((function(){return e.clock.resume()}))},getEncouragement:function(){var e=Math.floor(Math.random()*I.length);this.message=I[e]+"!"},getStyle:function(e){return{"background-color":e.color}},nextBlock:function(){var e=this,t=y(),r=j.createBlock(t);r||(console.log("cannot create block"),this.beginClearLines([this.grid.length-1,this.grid.length-2],(function(){return e.nextBlock()})))},tick:function(){var e=this,t=j.isSettled();if(t){var r=j.getLineClears();this.beginClearLines(r,(function(){return e.nextBlock()}))}else j.exertGravity()}},destroyed:function(){this.clock.destroy(),this.keyboardListener.destroy()}},P=M,K=(r("82c6"),r("2877")),G=Object(K["a"])(P,c,s,!1,null,"e0e0af1c",null),Y=G.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap"},[r("div",[r("Key",{attrs:{text:"⬅"}}),r("Key",{attrs:{text:"➡"}}),e._v(" Move ")],1),r("div",[r("Key",{attrs:{text:"⬆"}}),e._v(" Rotate ")],1),r("div",[r("Key",{attrs:{text:"⬇"}}),e._v(" Drop ")],1)])},$=[],A=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap"},[r("div",{staticClass:"key",domProps:{textContent:e._s(e.text)}})])},W=[],q={data:function(){return{}},props:{text:{required:!0,type:String}}},U=q,J=(r("0daa"),Object(K["a"])(U,A,W,!1,null,"229c90ee",null)),F=J.exports,H={components:{Key:F}},z=H,Q=(r("dd4b"),Object(K["a"])(z,N,$,!1,null,"7881e9c6",null)),V=Q.exports,X={name:"App",components:{Game:Y,Instructions:V},data:function(){return{score:0}},methods:{lineCleared:function(){this.score="a billion"}}},Z=X,ee=(r("034f"),Object(K["a"])(Z,i,o,!1,null,null,null)),te=ee.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(te)}}).$mount("#app")},"82c6":function(e,t,r){"use strict";var n=r("1b65"),i=r.n(n);i.a},"847e":function(e,t,r){},"85ec":function(e,t,r){},dd4b:function(e,t,r){"use strict";var n=r("847e"),i=r.n(n);i.a}});
//# sourceMappingURL=app.9daf5db4.js.map